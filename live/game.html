<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hack4n</title>
    <link href="style.css" rel="stylesheet">
    <title>hack4n</title>
    <link rel="icon" type="image/x-icon" href="https://i.scdn.co/image/ab67616d0000b273a875c3ec944b4f164ab5c350">
  </head>

  <body>
    <div class="bar">
      <a href="live.html"><img src="../home/nathan.jpg" height="140px"></a>

      <a href="live.html" style="color: black; text-decoration: none;"><h1 id="webtitle">Live Games and Stats</h1></a>
  </div>
  <div style="height: 150px;"></div>

  <div id="title"></div>

  <div id="gamestats"><p>No Game Data</p></div>

  <script>
    // get gameID
    const urlParams = new URLSearchParams(window.location.search);
    const gameID = urlParams.get('game');
    const home = urlParams.get('home');
    const away = urlParams.get('away');
    const started = urlParams.get('start');
    
    console.log(started)

    async function getInfo(){
        try {
                const response = await fetch('http://localhost:420/game?gameID='+gameID+'&home='+home+'&away='+away, {
                    method: 'GET',
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const gamedata = await response.json();
                console.log(gamedata);

                document.querySelector('#title').innerHTML += '<h1>'+home+' vs '+away+'</h1>'
                document.querySelector('#title').innerHTML += '<h2>'+started+'</h2>'
                document.querySelector('#title').innerHTML += '<a target="_blank" href="'+gamedata['url']+'">'+gamedata['url']+'</a>'


                // --------------------------------- check if game stats exist ------------------------------------------

                // if game has started, web scrape nba for game player stat data
                if (started[0] == 'G'){
                    document.querySelector('#gamestats').innerHTML = '<p>get game player stats through python backend /game</p>'
                
                // display no game data
                } else {
                    document.querySelector('#gamestats').innerHTML = '<p>No game data yet</p>'
                }
                
                // --------------------------------- check if prediction has been made ------------------------------------------

                // 
                // try {
                //     const response = await fetch('http://localhost:420/prediction?gameId='+gameID, {
                //         method: 'GET',
                //     });

                //     if (!response.ok) {
                //         throw new Error(`HTTP error! Status: ${response.status}`);
                //     }

                //     const prediction = await response.json();
                //     console.log(prediction)
                
                // } catch (error) {
                //     console.error('Error fetching search results:', error);
                // }

            } catch (error) {
                console.error('Error fetching search results:', error);
            }
    }
    getInfo()
        

  </script>
    
  </body>
</html>
